<!DOCTYPE HTML>
<html>
    <head>
        <meta content="text/html; charset=UTF-8" http-equiv="content-type">
        <title>Интерактивная схема алгоритма Эль Гамаля</title>
        <link type="text/css" rel="stylesheet" href="css/style.css"/>
    </head>
    <body>

    <nav id = "header">
        <div id = "title">Алгоритм Эль Гамаля</div>

        <ul id = "menu">
            <li>
                <a href = "#introduction" class = "nav-link">Введение</a>
            </li>
            <li>
                <a href = "#theory-block" class = "nav-link">Теория</a>
            </li>
            <li>
                <a href = "#interactive" class = "nav-link">Интерактивная схема</a>
            </li>
            <li>
                <a href = "#links" class = "nav-link">Источники</a>
            </li>
            <li>
                <a href = "https://github.com/The220th/DM2020_AltExam_ElGamalEncryption" class = "nav-link">Github проект</a>
            </li>
        </ul>
    </nav>

    <div id="wrapper">
        <div id = "introduction" class="block">
            <h1 class = "title">Введение</h1>
            <p class = "text">
                Цель алгоритмов шифрования - помочь людям обмениваться секретной или конфиденциальной информацией друг с другом, используя информационный эквивалент физических ключей. Чтобы облегчить обсуждение, мы скажем, что Боб хочет послать Алисе сообщение, чтобы Ева не смогла его увидеть. С симметричным алгоритмом шифрования ключ, используемый для шифрования сообщения, совпадает с ключом, используемым для его расшифровки. Это аналогично тому, как Боб помещает свое сообщение в ящик, закрывает его и отправляет Алисе для открытия. Большая проблема с таким подходом состоит в том, что Алиса нуждается в копии ключа, который использовал Боб. Это проблема курицы и яйца: для безопасного обмена информацией друг с другом Алиса и Боб уже должны были обмениваться секретной информацией. Если Боб когда-нибудь отправит ключ Алисе, Ева может легко перехватить его и использовать для чтения своих сообщений. Теоретически, Боб может дать Алисе ключ лично, но на практике это не очень хорошо работает. Представьте, что вам нужно ехать в офис какой-либо компании, чтобы дать им номер вашей кредитной карты, прежде чем вы сможете что-то купить онлайн. Это ужасно неудобно!
                <br/>
                <br/>
                Решением проблемы являются алгоритмы асимметричного шифрования,
                которые не используют один и тот же ключ для шифрования и дешифрования.
                Продолжая нашу аналогию с ящиками и физическими ключами, Алиса отправляет
                разблокированный замок всем, кто хочет отправлять ей сообщения.
                Боб кладет свое сообщение в ящик, запирает его замком Алисы и отправляет обратно Алисе.
                Поскольку Алиса - единственная, у кого есть ключ от замка,
                только она может прочитать сообщение, как только оно окажется в запертом ящике.
                Алгоритм Эль Гамаля является примером информационного алгоритма,
                который работает по этому принципу.
                В основу криптографической системы Эль Гамаля
                положена сложность задачи вычисления дискретных логарифмов в конечном поле.
                Существуют эффективные алгоритмы возведения числа в степень в конечном поле,
                однако восстановление показателя (дискретного логарифма) по известному
                основанию и его степени является сложной математической задачей.
                На сегодняшний день не известно ни одного эффективного алгоритма
                вычисления дискретных логарифмов больших чисел
            </p>
        </div>

        <div id = "theory-chipher" class="block">
            <h1 class = "title">Работа в режиме шифрования</h1>
            <p class = "text">
                Алиса хочет, чтобы люди могли отправлять ей секретные сообщения, поэтому она создает открытый ключ (р, g, h),
                которым она делится с миром и личный ключом x, который она никогда никому не рассказывает.
                Боб хочет отправить Алисе секретное сообщение, поэтому он использует открытый ключ Алисы и одноразовый сессионный ключ R, создает зашифрованный текст (s1 , s2).<br/>
                Вот как это работает:
            </p>
            <div class="example">
                <p class="alice-column-start">
                    <img src="images/Alice.svg" alt="Alice" />
                </p>
                <p class="bob-column-start">
                    <img src="images/Bob.svg" alt="Bob" />
                </p>
                <p class="alice-column">1.Алиса выбирает простое число p</p>
                <p class="alice-column">2.Выбирает целое число G, такое, что G - первообразный корень P</p>
                <p class="alice-column">3.Выбирает случайный секретный ключ, такой что 1 < x < P-1.</p>
                <p class="alice-column">3.Вычисляет H = G^X mod P</p>
                <p class="alice-column send-right">5.Публикует открытый ключ (p,g,h).</p>
                <p class="bob-column">1.Смотрит на ключ Алисы (p,g,y).</p>
                <p class="bob-column">2.Боб выбирает случайное R, такое что 1 < R < P - 1, НОД(R, P-1) = 1</p>
                <p class="bob-column">3.Создает сообщение m, такое что 0 < m < p. Если сообщение слишком большое, то
                Боб делит сообщение на части и шифрует их отдельно.</p>
                <p class="bob-column">4.Вычисляет числа s1 = G^R mod P, s2 = (H^R)*M mod P.</p>
                <p class="bob-column send-left">5.Боб публикует шифр текст (s1, s2).</p>
                <p class="alice-column">6.Алиса видит шифртекст (s1, s2).</p>
                <p class="alice-column">7.Расшифровывает сообщение m = s1^(-x)*s2 mod P.</p>
            </div>
        </div>

        <div id = "interactive" class="block">
            <h1 class = "title">Интерактивная схема</h1>
            <p class = "text">
                Это небольшое приложение, которое вы можете использовать,
                чтобы попробовать шифрование Эль Гамаля.<br>
                Это игрушечная реализация, поэтому, пожалуйста, даже не пытайтесь
                использовать большие числа))
            </p>
            <div class="row">
                <div class="col">
                    <div class = "machine" id="aliceMachine">
                        <div class="machine-title-panel">
                            <h3 class="machine-title">Алиса</h3>
                        </div>
                        <div class = "machine-main">
                            <ul class="errors"></ul>
                            <form>
                              <div class="form-group" id="prime">
                                <label for="txtPrime">
                                  Введите простое число P
                                </label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="txtPrime"/>
                                    <button id="getGenerators" class="btn" type="button">Ввести</button>
                                </div>
                                <span class="errorInfo">Данное число не является простым</span>
                              </div>

                              <div class="form-group" id="generator">
                                <label for="txtG">
                                  Выберете примитивный корень G
                                </label>
                                <div id="generatorInfo">Нажмите на кнопку выше, чтоб увидеть спиcок примитивных корней</div>
                                <div id="selectG"></div>
                                <span class="errorInfo">Ошибка</span>
                              </div>

                              <div class="form-group" id="privateKey">
                                <label for="txtPrivateKey">
                                  Введите приватный ключ X
                                </label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="txtPrivateKey"/>
                                    <button id="getRandomPrivateKey" class="btn" type="button">Рандом</button>
                                </div>
                                <span class="errorInfo">Число должно быть больше 0 и меньше (P-1)</span>
                              </div>

                              <div class="form-group">
                                  <button id="getPublicKey" class = "btn" type="button">
                                    Сгенерировать и Опубликовать Открытый ключ
                                  </button>
                              </div>
                            </form>
                        </div>

                        <div class="message">
                            <div id="messageDisplay">
                              <div class="inbox-empty" style="display: block">
                                У вас нет сообщений.
                              </div>
                              <div class="inbox-has-message" style="display: none">
                                <div>Вы получили сообщение от Боба. <button id="decrypt" class="btn btn-primary btn-sm" type="button">Расшифровать</button></div>
                                <div class="data" style="font-weight: bold;margin-top:10px;"></div>
                              </div>
                            </div>
                        </div>

                        <div class="extrainfo"></div>
                    </div>
            </div>
            <!-- ТАБЛИЦА ДАННЫХ -->

                <div class="col">
                    <div id="wire">
                        <div class="wire-data">
                            <div id="keyDisplay" class="display">
                                Публичный ключ<br/>
                                <span class="data">-</span>
                            </div>

                            <div id="encryptedMsg" class="display">
                                Зашифрованное сообщение<br/>
                                <span class="data">-</span>
                            </div>
                        </div>
                    </div>
                </div>

            <!-- ВТОРОЙ АБОНЕНТ -->

            <div class="col">
                <div class="machine" id="bobMachine">
                    <div class="machine-title-panel">
                        <h3 class="machine-title">Боб</h3>
                    </div>
                <div class="machine-main">
                  <form>
                    <div class="form-group" id="encryptPrivate">
                      <label for="txtEncryptPrivate">
                        Введите закрытый ключ для шифрования R
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="txtEncryptPrivate"/>
                        <div class="input-group-btn">
                          <button id="getRandomEncyptKey" class="btn" type="button">Рандом</button>
                        </div>
                      </div>
                      <span class="errorInfo">Число должно быть больше 0 и меньше (P - 1)</span>
                    </div>

                    <div class="form-group" id="message">
                      <label for="txtMessage">
                        Сообщение M
                      </label>
                      <div class="input-group">
                            <input type="text" class="form-control" id="txtMessage"/>
                            <button id="encrypt" class="btn" type="button">
                                Отправить
                            </button>
                        </div>
                      <span class="errorInfo">Число должно быть больше 0 и меньше P.</span>
                    </div>

                  </form>
                  <div class="extrainfo"></div>
                </div>
              </div>
            </div>

        </div>
    </div>

    <div id = "theory-signature" class="block">
        <h1 class = "title">Работа в режиме подписи</h1>
        <h2 class = "subtitle">Подпись сообщений</h2>
        <p class = "text">
            Для подписи сообщения M выполняются следующие операции:  <br>
            1) Вычисляется дайджест сообщения M: m = h(M) (Хеш-функция может быть любой) <br>
            2) Выбирается случайное число 1 < k < p-1 взаимнопростое с p-1 и вычисляется r = g^k(mod p) <br>
            3) Вычисляется число s = (m - xr)k^-1(mod p-1) <br>
            4) Подписью сообщения M является пара (r,s) <br>
        </p>
        <h2 class = "subtitle">Проверка подписи</h2>
        <p class = "text">
            Зная открытый ключ (p,g,h), подпись (r,s) сообщения M проверяется следующим образом: <br>
            1) Проверяется выполнимость условий: 0 < r < p и 0 < s < p-1 <br>
            2) Вычисляется дайджест сообщения M: m = h(M) <br>
            3) Подпись считается верной, если выполняется сравнение: y^r*r^s == g^m (mod p)<br>
            <br>
        </p>
    </div>

    <div id = "links" class="block">
        <h1 class = "title">Источники</h1>
        <p class = "text">
            Источники, которые мы использовали.
        </p>
        <ul class = "list">
            <li>
                <a href = "http://caislab.kaist.ac.kr/lecture/2010/spring/cs548/basic/B02.pdf">
                    <b>El Gamal T.</b> - A public key cryptosystem and a signature scheme based on discrete logarithms
                </a>
            </li>
            <li>
                <a href = "http://cyber.sibsutis.ru/%D0%A1%D0%9F%D0%98/%D0%9F%D0%B5%D1%80%D0%B2%D0%B0%D1%8F%20%D1%87%D0%B0%D1%81%D1%82%D1%8C/%D0%9A%D0%9C%D0%97%D0%98.pdf">
                    <b>Рябко, Фионов</b> - Криптографические методы защиты информации
                </a>
            </li>
            <li>
                <a href = "http://www.cacr.math.uwaterloo.ca/hac/about/chap11.pdf">
                    <b>Menezes A. J., Oorschot P. v., Vanstone S. A</b> - Handbook of Applied Cryptography
                </a>
            </li>
        </ul>
    </div>
    <footer>

    </footer>
    </div>
    <script src="js/elgamal.js"></script>
    <script src="js/machines.js"></script>
  </body>
</html>
